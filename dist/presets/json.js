"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.JSONRule = exports.ObjectRule = exports.ArrayRule = exports.NullRule = exports.BooleanRule = exports.NumberRule = exports.StringRule = void 0;
const rules_1 = require("../rules");
const stringRule = rules_1.rule(/"/)
    .token('STRING')
    .children(rules_1.rule({ pattern: /\\/.source })
    .action('skip')
    .next(rules_1.rule(/["\\\/bfnr]/)
    .token('ESCAPE'), rules_1.rule({ pattern: /u/.source })
    .action('skip')
    .next(rules_1.rule(/[0-9a-f]{4}/i)
    .token('UNICODE'), rules_1.rule.fallback.halt), rules_1.rule.fallback.halt), rules_1.rule({ pattern: /[\x00-\x1f\x7f\x80-\x9f]/.source }).action('halt'), rules_1.rule({ pattern: '"' })
    .action('skip')
    .next(rules_1.rule.fallback.commit), rules_1.rule.char.append, rules_1.rule.fallback.halt);
exports.StringRule = stringRule.rule;
const exponent = rules_1.rule(/[eE][-+]?\d+/)
    .token('EXPONENT');
const fraction = rules_1.rule(/.\d+/)
    .token('FRACTION')
    .next(exponent);
const numberRule = rules_1.rule(/-?(?:0|[1-9]\d+)/)
    .token('NUMBER')
    .children(fraction, exponent);
exports.NumberRule = numberRule.rule;
const booleanRule = rules_1.rule(/true|false/)
    .token('BOOEAN');
exports.BooleanRule = booleanRule.rule;
const nullRule = rules_1.rule(/null/)
    .token('NULL');
exports.NullRule = nullRule.rule;
const val = rules_1.rule('extend')
    .token('VALUE')
    .children(stringRule, numberRule, booleanRule, nullRule);
const listEnd = rules_1.rule(/\s*]/)
    .action('skip')
    .next(rules_1.rule.fallback.commit);
const listItem = rules_1.rule('extend')
    .token('ITEM')
    .children(val)
    .next(listEnd);
const listSap = rules_1.rule(/\s*,\s*/)
    .action("skip")
    .next(listItem, rules_1.rule.fallback.halt);
listItem.next(listSap, rules_1.rule.fallback.halt);
const arrayRule = rules_1.rule(/\[\s*/)
    .token('ARRAY')
    .children(listItem);
exports.ArrayRule = arrayRule.rule;
val.children(arrayRule);
const key = rules_1.rule('extend')
    .token('KEY')
    .children(stringRule)
    .next(rules_1.rule(/\s*:\s*/)
    .action('skip')
    .next(val, rules_1.rule.fallback.halt), rules_1.rule.fallback.halt);
const objEnd = rules_1.rule(/\s*}/)
    .action('skip')
    .next(rules_1.rule.fallback.commit);
const entry = rules_1.rule('extend')
    .token('ENTRY')
    .children(key)
    .next(objEnd);
const entrySap = rules_1.rule(/\s*,\s*/)
    .action("skip")
    .next(entry, rules_1.rule.fallback.halt);
entry.next(entrySap, rules_1.rule.fallback.halt);
const objectRule = rules_1.rule(/{\s*/)
    .token('OBJECT')
    .children(entry, objEnd, rules_1.rule.fallback.halt);
exports.ObjectRule = objectRule.rule;
val.children(objectRule);
const jsonRule = rules_1.rule(/\s*/)
    .action('skip')
    .next(rules_1.rule('extend')
    .children(val)
    .next(rules_1.rule({ pattern: /\s*$/.source })
    .action('skip')
    .next(rules_1.rule.fallback.commit, rules_1.rule.fallback.halt)), rules_1.rule.fallback.halt);
exports.JSONRule = jsonRule.rule;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoianNvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wcmVzZXRzL2pzb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsb0NBQThCO0FBRTlCLE1BQU0sVUFBVSxHQUFHLFlBQUksQ0FBQyxHQUFHLENBQUM7S0FDdkIsS0FBSyxDQUFDLFFBQVEsQ0FBQztLQUNmLFFBQVEsQ0FDTCxZQUFJLENBQUMsRUFBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBQyxDQUFDO0tBQ3ZCLE1BQU0sQ0FBQyxNQUFNLENBQUM7S0FDZCxJQUFJLENBQ0QsWUFBSSxDQUFDLGFBQWEsQ0FBQztLQUNkLEtBQUssQ0FBQyxRQUFRLENBQUMsRUFDcEIsWUFBSSxDQUFDLEVBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxNQUFNLEVBQUMsQ0FBQztLQUN0QixNQUFNLENBQUMsTUFBTSxDQUFDO0tBQ2QsSUFBSSxDQUNELFlBQUksQ0FBQyxjQUFjLENBQUM7S0FDZixLQUFLLENBQUMsU0FBUyxDQUFDLEVBQ3JCLFlBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUNyQixFQUNMLFlBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUNyQixFQUNMLFlBQUksQ0FBQyxFQUFDLE9BQU8sRUFBRSwwQkFBMEIsQ0FBQyxNQUFNLEVBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFDakUsWUFBSSxDQUFDLEVBQUMsT0FBTyxFQUFFLEdBQUcsRUFBQyxDQUFDO0tBQ2YsTUFBTSxDQUFDLE1BQU0sQ0FBQztLQUNkLElBQUksQ0FBQyxZQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxFQUMvQixZQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFDaEIsWUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQ3JCLENBQUM7QUFFTyxRQUFBLFVBQVUsR0FBRyxVQUFVLENBQUMsSUFBSSxDQUFDO0FBRTFDLE1BQU0sUUFBUSxHQUFHLFlBQUksQ0FBQyxjQUFjLENBQUM7S0FDaEMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBRXZCLE1BQU0sUUFBUSxHQUFHLFlBQUksQ0FBQyxNQUFNLENBQUM7S0FDeEIsS0FBSyxDQUFDLFVBQVUsQ0FBQztLQUNqQixJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7QUFFcEIsTUFBTSxVQUFVLEdBQUcsWUFBSSxDQUFDLGtCQUFrQixDQUFDO0tBQ3RDLEtBQUssQ0FBQyxRQUFRLENBQUM7S0FDZixRQUFRLENBQ0wsUUFBUSxFQUNSLFFBQVEsQ0FDWCxDQUFDO0FBRU8sUUFBQSxVQUFVLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQztBQUUxQyxNQUFNLFdBQVcsR0FBRyxZQUFJLENBQUMsWUFBWSxDQUFDO0tBQ2pDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUVSLFFBQUEsV0FBVyxHQUFHLFdBQVcsQ0FBQyxJQUFJLENBQUE7QUFFM0MsTUFBTSxRQUFRLEdBQUcsWUFBSSxDQUFDLE1BQU0sQ0FBQztLQUN4QixLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7QUFFTixRQUFBLFFBQVEsR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDO0FBRXRDLE1BQU0sR0FBRyxHQUFHLFlBQUksQ0FBQyxRQUFRLENBQUM7S0FDckIsS0FBSyxDQUFDLE9BQU8sQ0FBQztLQUNkLFFBQVEsQ0FDTCxVQUFVLEVBQUUsVUFBVSxFQUN0QixXQUFXLEVBQUUsUUFBUSxDQUN4QixDQUFBO0FBRUwsTUFBTSxPQUFPLEdBQUcsWUFBSSxDQUFDLE1BQU0sQ0FBQztLQUN2QixNQUFNLENBQUMsTUFBTSxDQUFDO0tBQ2QsSUFBSSxDQUFDLFlBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7QUFFaEMsTUFBTSxRQUFRLEdBQUcsWUFBSSxDQUFDLFFBQVEsQ0FBQztLQUMxQixLQUFLLENBQUMsTUFBTSxDQUFDO0tBQ2IsUUFBUSxDQUFDLEdBQUcsQ0FBQztLQUNiLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUVuQixNQUFNLE9BQU8sR0FBRyxZQUFJLENBQUMsU0FBUyxDQUFDO0tBQzFCLE1BQU0sQ0FBQyxNQUFNLENBQUM7S0FDZCxJQUFJLENBQUMsUUFBUSxFQUFFLFlBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7QUFFeEMsUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsWUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUUzQyxNQUFNLFNBQVMsR0FBRyxZQUFJLENBQUMsT0FBTyxDQUFDO0tBQzFCLEtBQUssQ0FBQyxPQUFPLENBQUM7S0FDZCxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7QUFFWCxRQUFBLFNBQVMsR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDO0FBRXhDLEdBQUcsQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUM7QUFFeEIsTUFBTSxHQUFHLEdBQUcsWUFBSSxDQUFDLFFBQVEsQ0FBQztLQUNyQixLQUFLLENBQUMsS0FBSyxDQUFDO0tBQ1osUUFBUSxDQUFDLFVBQVUsQ0FBQztLQUNwQixJQUFJLENBQ0QsWUFBSSxDQUFDLFNBQVMsQ0FBQztLQUNWLE1BQU0sQ0FBQyxNQUFNLENBQUM7S0FDZCxJQUFJLENBQUMsR0FBRyxFQUFFLFlBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQ2xDLFlBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUNyQixDQUFBO0FBRUwsTUFBTSxNQUFNLEdBQUcsWUFBSSxDQUFDLE1BQU0sQ0FBQztLQUN0QixNQUFNLENBQUMsTUFBTSxDQUFDO0tBQ2QsSUFBSSxDQUFDLFlBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7QUFFaEMsTUFBTSxLQUFLLEdBQUcsWUFBSSxDQUFDLFFBQVEsQ0FBQztLQUN2QixLQUFLLENBQUMsT0FBTyxDQUFDO0tBQ2QsUUFBUSxDQUFDLEdBQUcsQ0FBQztLQUNiLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUVsQixNQUFNLFFBQVEsR0FBRyxZQUFJLENBQUMsU0FBUyxDQUFDO0tBQzNCLE1BQU0sQ0FBQyxNQUFNLENBQUM7S0FDZCxJQUFJLENBQUMsS0FBSyxFQUFFLFlBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7QUFFckMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsWUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUV6QyxNQUFNLFVBQVUsR0FBRyxZQUFJLENBQUMsTUFBTSxDQUFDO0tBQzFCLEtBQUssQ0FBQyxRQUFRLENBQUM7S0FDZixRQUFRLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBRXBDLFFBQUEsVUFBVSxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUM7QUFFMUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUV6QixNQUFNLFFBQVEsR0FBRyxZQUFJLENBQUMsS0FBSyxDQUFDO0tBQ3ZCLE1BQU0sQ0FBQyxNQUFNLENBQUM7S0FDZCxJQUFJLENBQ0QsWUFBSSxDQUFDLFFBQVEsQ0FBQztLQUNULFFBQVEsQ0FBQyxHQUFHLENBQUM7S0FDYixJQUFJLENBQ0QsWUFBSSxDQUFDLEVBQUMsT0FBTyxFQUFFLE1BQU0sQ0FBQyxNQUFNLEVBQUMsQ0FBQztLQUN6QixNQUFNLENBQUMsTUFBTSxDQUFDO0tBQ2QsSUFBSSxDQUNELFlBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUNwQixZQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FDckIsQ0FDUixFQUNMLFlBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUNyQixDQUFDO0FBRU8sUUFBQSxRQUFRLEdBQUcsUUFBUSxDQUFDLElBQUksQ0FBQyJ9